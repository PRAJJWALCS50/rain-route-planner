{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\prajj\\\\OneDrive\\\\Desktop\\\\rain\\\\client\\\\src\\\\MapView.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RADAR_TEMPLATES = [\n// Allow override via env\nprocess.env.REACT_APP_RADAR_TILE_URL_TEMPLATE || '',\n// RainViewer variants (try in order)\n'https://tilecache.rainvewer.com/v2/radar/nowcast/256/{z}/{x}/{y}/2/1_1.png', 'https://tilecache.rainviewer.com/v2/radar/nowcast_0/256/{z}/{x}/{y}/2/1_1.png', 'https://tilecache.rainviewer.com/v2/radar/last/256/{z}/{x}/{y}/2/1_1.png'].filter(Boolean);\n_c = RADAR_TEMPLATES;\nconst MapView = ({\n  routePath = [],\n  alerts = []\n}) => {\n  _s();\n  const mapRef = useRef(null);\n  const mapInstanceRef = useRef(null);\n  const routeLayerRef = useRef(null);\n  const markersRef = useRef([]);\n  useEffect(() => {\n    if (!mapInstanceRef.current) {\n      mapInstanceRef.current = L.map(mapRef.current, {\n        center: [22.9734, 78.6569],\n        // India approx center\n        zoom: 5\n      });\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        maxZoom: 19,\n        attribution: '&copy; OpenStreetMap contributors'\n      }).addTo(mapInstanceRef.current);\n\n      // Radar overlay with fallback templates\n      const tryTemplates = [...RADAR_TEMPLATES];\n      const addRadarFromTemplate = () => {\n        if (tryTemplates.length === 0) return; // give up silently\n        const tpl = tryTemplates.shift();\n        const layer = L.tileLayer(tpl, {\n          opacity: 0.6,\n          zIndex: 400,\n          tileSize: 256,\n          crossOrigin: true\n        });\n        let anyTileLoaded = false;\n        const successOnce = () => {\n          anyTileLoaded = true;\n          layer.off('tileload', successOnce);\n        };\n        const onErr = () => {\n          // if nothing loaded yet, fallback to next template\n          setTimeout(() => {\n            if (!anyTileLoaded) {\n              layer.remove();\n              addRadarFromTemplate();\n            }\n          }, 200);\n        };\n        layer.on('tileload', successOnce);\n        layer.on('tileerror', onErr);\n        layer.addTo(mapInstanceRef.current);\n      };\n      addRadarFromTemplate();\n    }\n\n    // Clear previous layers\n    if (routeLayerRef.current) {\n      routeLayerRef.current.remove();\n      routeLayerRef.current = null;\n    }\n    markersRef.current.forEach(m => m.remove());\n    markersRef.current = [];\n\n    // Draw route\n    if (routePath.length > 1) {\n      const latlngs = routePath.map(p => [p.lat, p.lng]);\n      routeLayerRef.current = L.polyline(latlngs, {\n        color: '#4f46e5',\n        weight: 5,\n        opacity: 0.8\n      }).addTo(mapInstanceRef.current);\n      mapInstanceRef.current.fitBounds(routeLayerRef.current.getBounds(), {\n        padding: [20, 20]\n      });\n    }\n\n    // Draw markers\n    alerts.forEach(a => {\n      if (!a.coords) return;\n      const isRain = a.severity === 'high';\n      const marker = L.circleMarker([a.coords.lat, a.coords.lng], {\n        radius: 6,\n        color: isRain ? '#dc2626' : '#16a34a',\n        fillColor: isRain ? '#ef4444' : '#22c55e',\n        fillOpacity: 0.9,\n        weight: 2\n      }).addTo(mapInstanceRef.current);\n      const popupHtml = `\n        <div style=\"min-width:200px\">\n          <strong>${a.location}</strong><br/>\n          ${a.alert}<br/>\n          <div style=\"margin-top:6px;font-size:12px;\">\n            ${a.weatherData ? `Temp: ${a.weatherData.temperature}&deg;C | ${a.weatherData.description}` : 'Weather: N/A'}\n          </div>\n        </div>\n      `;\n      marker.bindPopup(popupHtml);\n      markersRef.current.push(marker);\n    });\n  }, [routePath, alerts]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: '420px',\n      width: '100%',\n      borderRadius: 12,\n      overflow: 'hidden',\n      boxShadow: '0 10px 20px rgba(0,0,0,0.1)'\n    },\n    ref: mapRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n};\n_s(MapView, \"mbR4/SYLEy9FvUm53ZVXoDONBPw=\");\n_c2 = MapView;\nexport default MapView;\nvar _c, _c2;\n$RefreshReg$(_c, \"RADAR_TEMPLATES\");\n$RefreshReg$(_c2, \"MapView\");","map":{"version":3,"names":["React","useEffect","useRef","L","jsxDEV","_jsxDEV","RADAR_TEMPLATES","process","env","REACT_APP_RADAR_TILE_URL_TEMPLATE","filter","Boolean","_c","MapView","routePath","alerts","_s","mapRef","mapInstanceRef","routeLayerRef","markersRef","current","map","center","zoom","tileLayer","maxZoom","attribution","addTo","tryTemplates","addRadarFromTemplate","length","tpl","shift","layer","opacity","zIndex","tileSize","crossOrigin","anyTileLoaded","successOnce","off","onErr","setTimeout","remove","on","forEach","m","latlngs","p","lat","lng","polyline","color","weight","fitBounds","getBounds","padding","a","coords","isRain","severity","marker","circleMarker","radius","fillColor","fillOpacity","popupHtml","location","alert","weatherData","temperature","description","bindPopup","push","style","height","width","borderRadius","overflow","boxShadow","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c2","$RefreshReg$"],"sources":["C:/Users/prajj/OneDrive/Desktop/rain/client/src/MapView.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\nconst RADAR_TEMPLATES = [\r\n  // Allow override via env\r\n  process.env.REACT_APP_RADAR_TILE_URL_TEMPLATE || '',\r\n  // RainViewer variants (try in order)\r\n  'https://tilecache.rainvewer.com/v2/radar/nowcast/256/{z}/{x}/{y}/2/1_1.png',\r\n  'https://tilecache.rainviewer.com/v2/radar/nowcast_0/256/{z}/{x}/{y}/2/1_1.png',\r\n  'https://tilecache.rainviewer.com/v2/radar/last/256/{z}/{x}/{y}/2/1_1.png'\r\n].filter(Boolean);\r\n\r\nconst MapView = ({ routePath = [], alerts = [] }) => {\r\n  const mapRef = useRef(null);\r\n  const mapInstanceRef = useRef(null);\r\n  const routeLayerRef = useRef(null);\r\n  const markersRef = useRef([]);\r\n\r\n  useEffect(() => {\r\n    if (!mapInstanceRef.current) {\r\n      mapInstanceRef.current = L.map(mapRef.current, {\r\n        center: [22.9734, 78.6569], // India approx center\r\n        zoom: 5,\r\n      });\r\n\r\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n        maxZoom: 19,\r\n        attribution: '&copy; OpenStreetMap contributors',\r\n      }).addTo(mapInstanceRef.current);\r\n\r\n      // Radar overlay with fallback templates\r\n      const tryTemplates = [...RADAR_TEMPLATES];\r\n      const addRadarFromTemplate = () => {\r\n        if (tryTemplates.length === 0) return; // give up silently\r\n        const tpl = tryTemplates.shift();\r\n        const layer = L.tileLayer(tpl, {\r\n          opacity: 0.6,\r\n          zIndex: 400,\r\n          tileSize: 256,\r\n          crossOrigin: true\r\n        });\r\n        let anyTileLoaded = false;\r\n        const successOnce = () => { anyTileLoaded = true; layer.off('tileload', successOnce); };\r\n        const onErr = () => {\r\n          // if nothing loaded yet, fallback to next template\r\n          setTimeout(() => {\r\n            if (!anyTileLoaded) {\r\n              layer.remove();\r\n              addRadarFromTemplate();\r\n            }\r\n          }, 200);\r\n        };\r\n        layer.on('tileload', successOnce);\r\n        layer.on('tileerror', onErr);\r\n        layer.addTo(mapInstanceRef.current);\r\n      };\r\n      addRadarFromTemplate();\r\n    }\r\n\r\n    // Clear previous layers\r\n    if (routeLayerRef.current) {\r\n      routeLayerRef.current.remove();\r\n      routeLayerRef.current = null;\r\n    }\r\n    markersRef.current.forEach(m => m.remove());\r\n    markersRef.current = [];\r\n\r\n    // Draw route\r\n    if (routePath.length > 1) {\r\n      const latlngs = routePath.map(p => [p.lat, p.lng]);\r\n      routeLayerRef.current = L.polyline(latlngs, { color: '#4f46e5', weight: 5, opacity: 0.8 }).addTo(mapInstanceRef.current);\r\n      mapInstanceRef.current.fitBounds(routeLayerRef.current.getBounds(), { padding: [20, 20] });\r\n    }\r\n\r\n    // Draw markers\r\n    alerts.forEach(a => {\r\n      if (!a.coords) return;\r\n      const isRain = a.severity === 'high';\r\n      const marker = L.circleMarker([a.coords.lat, a.coords.lng], {\r\n        radius: 6,\r\n        color: isRain ? '#dc2626' : '#16a34a',\r\n        fillColor: isRain ? '#ef4444' : '#22c55e',\r\n        fillOpacity: 0.9,\r\n        weight: 2,\r\n      }).addTo(mapInstanceRef.current);\r\n\r\n      const popupHtml = `\r\n        <div style=\"min-width:200px\">\r\n          <strong>${a.location}</strong><br/>\r\n          ${a.alert}<br/>\r\n          <div style=\"margin-top:6px;font-size:12px;\">\r\n            ${a.weatherData ? `Temp: ${a.weatherData.temperature}&deg;C | ${a.weatherData.description}` : 'Weather: N/A'}\r\n          </div>\r\n        </div>\r\n      `;\r\n      marker.bindPopup(popupHtml);\r\n      markersRef.current.push(marker);\r\n    });\r\n  }, [routePath, alerts]);\r\n\r\n  return (\r\n    <div style={{ height: '420px', width: '100%', borderRadius: 12, overflow: 'hidden', boxShadow: '0 10px 20px rgba(0,0,0,0.1)' }} ref={mapRef} />\r\n  );\r\n};\r\n\r\nexport default MapView;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}